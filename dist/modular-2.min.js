/*Jonas Karg 2018*/"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},Modular={data:{bindings:{},renderedEvent:new Event("mRendered"),onRender:new Event("mOnRender")},getBinding:function getBinding(a){var b=Modular.data.bindings[a];return b?b.value:void 0},setBinding:function setBinding(a,b){Modular.data.bindings[a]||(Modular.data.bindings[a]={value:void 0,elements:[],listeners:[],change:function change(c){Modular.data.bindings[a].listeners.map(function(d){d(Modular.data.bindings[a].value,c)})}}),Modular.data.bindings[a].value=b,Modular.data.bindings[a].change()},listenBinding:function listenBinding(a,b){Modular.data.bindings[a]||Modular.setBinding(a,void 0),Modular.data.bindings[a].listeners.push(b)},core:{getAttr:function getAttr(a){var b={};return Array.from(a).map(function(c){b[c.name]=c.value}),b},getHtml:function getHtml(a,b){if(!a)return null;var c;if(a instanceof Element)c=a;else if(a.constructor===Function)c=Modular.core.getHtml(a());else if(a.constructor===Array)c=document.createElement("div"),a.map(function(d){c.appendChild(Modular.core.getHtml(d))});else if(a.constructor===String||a.constructor===Number)c=document.createTextNode(a);else if(!(a.constructor===Object))throw Modular.core.err(3);else if(a.__config__&&"modular-element"===a.__config__.type)c=a.__config__.element;else throw Modular.core.err(2);return b?void b.appendChild(c):c},getStyle:function getStyle(a){var b=a;if("function"==typeof b&&(b=b()),"object"===("undefined"==typeof b?"undefined":_typeof(b))){var c=document.createElement("div");Object.assign(c.style,b),b=c.getAttribute("style")}return b},makeEl:function makeEl(a,b,c){var d=document.createElement(a),f={};return Object.assign(f,b||{}),delete f.__config__,f.style&&(f.style=Modular.core.getStyle(f.style)),Object.assign(d,f),c&&d.appendChild(c),d}},el:function el(){var a=Array.from(arguments),b=a[0],c=a[1]||{};if(a.splice(0,2),void 0!==c.__config__)throw Error(Modular.core.err(1));c.__config__={type:"modular-element",tag:b,content:a,binding:c.$bind,value:c.value||a,element:void 0},delete c.$bind;var d=c.__config__.binding;return c.__config__.element=Modular.core.makeEl(c.__config__.tag,c,Modular.core.getHtml(c.__config__.content)),d&&(c.__config__.element.addEventListener("click",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("change",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("hover",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("keyup",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("keydown",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("scroll",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("mouseover",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("mouseout",function(f){return c.__config__.change(f)}),c.__config__.element.addEventListener("contextmenu",function(f){return c.__config__.change(f)}),Modular.setBinding(d,c.__config__.value),Modular.listenBinding(d,function(f){Modular.data.bindings[d].elements.map(function(g){"INPUT"==g.tagName?g.value=f:g.innerHTML=f})}),c.__config__.change=function(){c.__config__.value=c.__config__.element.value||c.__config__.element.innerHTML,Modular.data.bindings[d].value=c.__config__.value,Modular.data.bindings[d].change()},Modular.data.bindings[d].elements.push(c.__config__.element),Modular.data.bindings[d].change()),c},scan:function scan(a){var b=document.createElement("div");b.innerHTML=a.trim();var c=Array.from(b.childNodes).map(function(d){return d instanceof Element?(isOnlyText=!1,Modular.el(d.tagName,Modular.core.getAttr(d.attributes),Modular.scan(d.innerHTML))):d.textContent});return c},render:function render(a,b){window.dispatchEvent(Modular.data.onRender);var c;if(c="string"==typeof b?document.querySelector(b):b,!(c instanceof Element))throw Modular.core.err(8);Modular.core.getHtml(a,c),window.dispatchEvent(Modular.data.renderedEvent)}};